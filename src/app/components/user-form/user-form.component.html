<!-- src/app/components/user-form/user-form.component.html -->
<div class="container mt-4">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <div>
            <h1 class="display-6 fw-bold text-primary">
              <i class="fas fa-user-plus me-2"></i>{{ title }}
            </h1>
            <p class="lead mb-0">
              {{ isEditMode ? 'Modifier les informations de l\'utilisateur' : 'Ajouter un nouvel utilisateur au système' }}
            </p>
          </div>
          <button class="btn btn-outline-secondary" (click)="goBack()">
            <i class="fas fa-arrow-left me-2"></i>Retour
          </button>
        </div>
  
        <!-- Loading State -->
        <div *ngIf="isLoading" class="text-center py-5">
          <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="visually-hidden">Chargement...</span>
          </div>
          <p class="mt-3 text-muted">Chargement des données...</p>
        </div>
  
        <!-- User Form -->
        <form [formGroup]="userForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading">
          <div class="card shadow">
            <div class="card-body p-4">
              <!-- Personal Information -->
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="prenom" class="form-label">Prénom *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="prenom"
                      formControlName="prenom"
                      [class.is-invalid]="prenom?.invalid && prenom?.touched"
                      placeholder="Entrez le prénom">
                    <div class="invalid-feedback" *ngIf="prenom?.errors?.['required'] && prenom?.touched">
                      Le prénom est obligatoire
                    </div>
                    <div class="invalid-feedback" *ngIf="prenom?.errors?.['minlength'] && prenom?.touched">
                      Le prénom doit contenir au moins 2 caractères
                    </div>
                  </div>
                </div>
                
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="nom" class="form-label">Nom *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="nom"
                      formControlName="nom"
                      [class.is-invalid]="nom?.invalid && nom?.touched"
                      placeholder="Entrez le nom">
                    <div class="invalid-feedback" *ngIf="nom?.errors?.['required'] && nom?.touched">
                      Le nom est obligatoire
                    </div>
                    <div class="invalid-feedback" *ngIf="nom?.errors?.['minlength'] && nom?.touched">
                      Le nom doit contenir au moins 2 caractères
                    </div>
                  </div>
                </div>
              </div>
  
              <!-- Email -->
              <div class="mb-3">
                <label for="email" class="form-label">Email *</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  formControlName="email"
                  [class.is-invalid]="email?.invalid && email?.touched"
                  placeholder="entrez l'adresse email">
                <div class="invalid-feedback" *ngIf="email?.errors?.['required'] && email?.touched">
                  L'email est obligatoire
                </div>
                <div class="invalid-feedback" *ngIf="email?.errors?.['email'] && email?.touched">
                  Veuillez entrer une adresse email valide
                </div>
              </div>
  
              <!-- Password (not required in edit mode) -->
              <div class="mb-3">
                <label for="password" class="form-label">
                  Mot de passe {{ isEditMode ? '' : '*' }}
                </label>
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  formControlName="password"
                  [class.is-invalid]="password?.invalid && password?.touched"
                  [placeholder]="isEditMode ? 'Laisser vide pour ne pas modifier' : 'Entrez le mot de passe'">
                <div class="form-text" *ngIf="isEditMode">
                  Laisser ce champ vide si vous ne souhaitez pas modifier le mot de passe
                </div>
                <div class="invalid-feedback" *ngIf="password?.errors?.['required'] && password?.touched && !isEditMode">
                  Le mot de passe est obligatoire
                </div>
                <div class="invalid-feedback" *ngIf="password?.errors?.['minlength'] && password?.touched">
                  Le mot de passe doit contenir au moins 6 caractères
                </div>
              </div>
  
              <!-- Role -->
              <div class="mb-4">
                <label for="role" class="form-label">Rôle *</label>
                <select
                  class="form-select"
                  id="role"
                  formControlName="role"
                  [class.is-invalid]="role?.invalid && role?.touched">
                  <option value="user">Utilisateur</option>
                  <option value="admin">Administrateur</option>
                </select>
                <div class="invalid-feedback" *ngIf="role?.errors?.['required'] && role?.touched">
                  Le rôle est obligatoire
                </div>
              </div>
  
              <!-- Action Buttons -->
              <div class="d-flex gap-2 justify-content-end pt-3 border-top">
                <button type="button" class="btn btn-outline-secondary" (click)="goBack()">
                  <i class="fas fa-times me-2"></i>Annuler
                </button>
                <button 
                  type="submit" 
                  class="btn btn-primary"
                  [disabled]="isSubmitting || userForm.invalid">
                  <i class="fas fa-save me-2"></i>{{ submitButtonText }}
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>