<!-- src/app/components/user-profile/user-profile.component.html -->
<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1 class="display-5 fw-bold text-primary">
            <i class="bi bi-person-circle me-2"></i>Mon Profil
          </h1>
          <p class="lead mb-0">Informations de votre compte</p>
        </div>
        <button class="btn btn-outline-secondary" (click)="goBack()">
          <i class="bi bi-arrow-left me-2"></i>Retour
        </button>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="text-center py-5">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
          <span class="visually-hidden">Chargement...</span>
        </div>
        <p class="mt-3 text-muted">Chargement du profil...</p>
      </div>

      <!-- Profile Card -->
      <div *ngIf="!isLoading && currentUser" class="card shadow">
        <div class="card-body p-4">
          <!-- Profile Header with Avatar -->
          <div class="text-center mb-4">
            <div class="avatar-profile mx-auto mb-3" 
                 [style.background-color]="getAvatarColor()">
              {{ getAvatarInitials() }}
            </div>
            <h2 class="card-title">{{ currentUser.prenom }} {{ currentUser.nom }}</h2>
            <div class="d-flex justify-content-center align-items-center gap-2">
              <span class="badge" 
                    [class.bg-primary]="isAdmin()" 
                    [class.bg-secondary]="!isAdmin()">
                {{ getRoleDisplay() }}
              </span>
              <span class="badge bg-success">
                <i class="bi bi-check-circle me-1"></i>Compte Actif
              </span>
            </div>
          </div>

          <!-- User Details -->
          <div class="row">
            <!-- Personal Information -->
            <div class="col-md-6">
              <div class="card bg-light h-100">
                <div class="card-header">
                  <h5 class="card-title mb-0">
                    <i class="bi bi-person-vcard me-2"></i>Informations Personnelles
                  </h5>
                </div>
                <div class="card-body">
                  <div class="mb-3">
                    <label class="form-label text-muted small mb-1">Nom Complet</label>
                    <p class="mb-0 fw-semibold">{{ currentUser.prenom }} {{ currentUser.nom }}</p>
                  </div>
                  <div class="mb-3">
                    <label class="form-label text-muted small mb-1">Rôle</label>
                    <p class="mb-0 fw-semibold">
                      {{ getRoleDisplay() }}
                    </p>
                    <small class="text-muted">{{ getRoleDescription() }}</small>
                  </div>
                  <div>
                    <label class="form-label text-muted small mb-1">ID Utilisateur</label>
                    <p class="mb-0 font-monospace small text-muted" [title]="currentUser._id">
                      {{ getShortUserId() }}
                    </p>
                  </div>
                </div>
              </div>
            </div>

          <!-- Contact Information -->
<!-- Contact Information -->
<div class="col-md-6">
  <div class="card bg-light h-100">
    <div class="card-header">
      <h5 class="card-title mb-0">
        <i class="bi bi-envelope me-2"></i>Contact
      </h5>
    </div>
    <div class="card-body">
      <div class="mb-3">
        <label class="form-label text-muted small mb-1">Adresse Email</label>
        <p class="mb-0 fw-semibold">
          <!-- <a [href]="'mailto:' + currentUser?.email" class="text-decoration-none">
            {{ currentUser?.email }}
          </a> -->
          <a [href]="'mailto:' + currentUser.email" class="text-decoration-none">
            {{ currentUser.email }}
          </a>
        </p>
      </div>
      <div class="mb-3">
        <label class="form-label text-muted small mb-1">Date de Création</label>
        <p class="mb-0 fw-semibold">
          {{ userStats.accountCreation || 'Chargement...' }}
        </p>
      </div>
      <div>
        <label class="form-label text-muted small mb-1">Ancienneté du Compte</label>
        <p class="mb-0 fw-semibold">
          {{ userStats.accountAge || 'Chargement...' }}
        </p>
      </div>
    </div>
  </div>
</div>          <!-- System Information -->
          <div class="row mt-4">
            <div class="col-12">
              <div class="card bg-light">
                <div class="card-header">
                  <h5 class="card-title mb-0">
                    <i class="bi bi-graph-up me-2"></i>Statistiques du Compte
                  </h5>
                </div>
                <div class="card-body">
                  <div class="row">
                    <!-- Account Status -->
                    <div class="col-md-3 text-center">
                      <div class="p-3">
                        <i class="bi bi-person-check display-6 text-success mb-2"></i>
                        <h5>Compte Vérifié</h5>
                        <p class="text-muted small">Email confirmé et actif</p>
                      </div>
                    </div>

                    <!-- Last Activity -->
                    <div class="col-md-3 text-center">
                      <div class="p-3">
                        <i class="bi bi-clock-history display-6 text-primary mb-2"></i>
                        <h5>Dernière Activité</h5>
                        <p class="text-muted small">{{ userStats.lastLogin || 'Récemment' }}</p>
                      </div>
                    </div>

                    <!-- Students Count (Admin only) -->
                    <div class="col-md-3 text-center" *ngIf="isAdmin()">
                      <div class="p-3">
                        <i class="bi bi-people display-6 text-info mb-2"></i>
                        <h5>{{ userStats.totalStudents || '0' }} Étudiants</h5>
                        <p class="text-muted small">Dans le système</p>
                      </div>
                    </div>

                    <!-- Subjects Count (Admin only) -->
                    <div class="col-md-3 text-center" *ngIf="isAdmin()">
                      <div class="p-3">
                        <i class="bi bi-journals display-6 text-warning mb-2"></i>
                        <h5>{{ userStats.totalSubjects || '0' }} Matières</h5>
                        <p class="text-muted small">Uniques enseignées</p>
                      </div>
                    </div>

                    <!-- For regular users -->
                    <div class="col-md-3 text-center" *ngIf="!isAdmin()">
                      <div class="p-3">
                        <i class="bi bi-eye display-6 text-info mb-2"></i>
                        <h5>Accès Lecture</h5>
                        <p class="text-muted small">Consultation des données</p>
                      </div>
                    </div>

                    <!-- Account Age -->
                    <div class="col-md-3 text-center" *ngIf="!isAdmin()">
                      <div class="p-3">
                        <i class="bi bi-calendar-check display-6 text-warning mb-2"></i>
                        <h5>Membre depuis</h5>
                        <p class="text-muted small">{{ userStats.accountAge || 'Calcul...' }}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="d-flex gap-2 justify-content-center mt-4 pt-3 border-top">
            <button class="btn btn-outline-primary" (click)="editProfile()">
              <i class="bi bi-pencil me-2"></i>Modifier le Profil
            </button>
            <button class="btn btn-outline-secondary" (click)="goBack()">
              <i class="bi bi-house me-2"></i>Retour au Dashboard
            </button>
          </div>
        </div>
      </div>

      <!-- Error State -->
      <div *ngIf="!isLoading && !currentUser" class="alert alert-danger text-center">
        <i class="bi bi-exclamation-triangle me-2"></i>
        Impossible de charger les informations du profil.
        <button class="btn btn-sm btn-outline-danger ms-2" (click)="loadUserProfile()">
          Réessayer
        </button>
      </div>
    </div>
  </div>
</div>